# 工作总结( 2019.1.16 - 2019.3.31 )



王军柱  2019.4.3

[TOC]



## Ubuntu 16.04 32 位系统 + Linux 4.9.146 + xenomai3.0.8

- ### 安装Ubuntu 16.04 32位系统

 	使用uname -r查看内核版本 4.15.0-29-generic

​	 问题1：UEFI(BIOS升级版)，无法识别32位系统的U盘。

 		解决：disable secure boot

​	 问题2：安装接近尾声时，遇到安装错误。

 		解决：进入安装u盘，选试用，修改GRUB引导。

- ### 实时内核编译

  - 选择最新稳定版实时内核 Xenomai 3.0.8
  -  选择最新的 ipipe补丁 ipipe-core-4.14.89-x86-2.patch
  -  根据ipipe版本，选用对应的Linux内核源码(Linux 4.14.89)

​	问题1：编译出错太多，无法解决。

​        解决：当时对配置项不了解，修改了太多没必要修改的配置项。

​		　改为选用ipipe-core-4.9.146-x86-8.patch补丁和Linux 4.9.146内核。

- ### 内核实时性测试

  ​	问题1：当执行xenomai提供的测试程序时，桌面会挂死。

  ​        问题2：当打开多个terminal执行xenomai的测试程序，桌面很快会挂死。

  　　解决：没解决。(疑点：双显卡的问题，Unity桌面)

  　　　	  

## Ubuntu 16.04 64位系统 + Linux 4.14.89 +xenomai3.0.8

​		工控机到货后，获知是64位CPU，决定采用64位系统。直接使用工控机进行安装。

- ### 安装Ubuntu16.04 64位系统

- ### 使用最新的pipe-core-4.14.89-x86-2.patch

  ​	选用匹配的内核Linux 4.14.89。（一般和host系统版本号接近比较好。）

  ​	有了之前是经验，知道内核配置选项会默认采用安装时的config文件，内核配置并不需要修改太多，

​	主要集中在Xenomai的选择、实时Xenomai 3.0.8性相关选项和电源管理选项。

- ### 内核实时性测试

  　　平均延时2-3us, 抖动 20-30 usXenomai 3.0.8

  ​	不会挂死。(可能是工控机只有一个显卡，比较稳定)

  

## Orocol-toolchain(Log4cpp, RTT, OCL)

- ### 安装 boost 1.5.8

  ​	使用 ubuntu 命令安装

  　　手动安装

- ### 安装 log4cpp

  　　默认路径安装( /usr/local )

  ​		好处：不需要设置环境变量，安装简单。

  ​		坏处：和目录 /usr/local下的其他东西混杂在一起。

  ​       自定义安装路径（单独安装在一个目录中，如：/usr/local/orocos）

  ​		好处：干净，orocos-toochain所有的东西都安装在目录/usr/local/orocos下。

- ### 安装rtt



## dev_interface_lib

- ### 使用64位orocos库

- ### 使用64位的主栈代码 EC-Master-V2.9-Xenomai_x64( Acontis Technology)

- ### 编译生成64位的静态库libdev_interface.a



## dev_interface_proj

​	主栈启动有问题



## EC-Master-V2.9-Xenomai_x64( Acontis Technology)	

​	atemsys.c 中有个函数没有修改为支持 COBALT内核(xenomai 3.0.8的双内核模式)，

​	已反馈给盟通人员修改，这个修改可能比较复杂。



## 代码阅读

​	Xenomai 3.0.8

​	Linux 4.14.89

​	Orocos RTT, log4cpp, ocl

​	dev_interface_dev

​	dev_interface_proj

​	EC-Master-V2.9-Xenomai_x64



完